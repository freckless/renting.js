<!DOCTYPE html><html lang="en"><head><title>server</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="server"><meta name="groc-project-path" content="server.js"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path">server.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="modulo-do-servidor">Modulo do servidor</h1>
<p>Modulo que inicia a escoita do servidor web, carga as configuracións
e inicializa a conexión coa base de datos, os modelos, etc...</p></div></div><div class="code"><div class="wrapper"><span class="hljs-pi">
'use strict'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="dependencias-do-mdulo">Dependencias do módulo</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>),
    path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="bootstrap">Bootstrap</h2>
<p>Configuramos o entorno se non está configurado</p></div></div><div class="code"><div class="wrapper">process.env.NODE_ENV = process.env.NODE_ENV || <span class="hljs-string">'development'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Configuramos a carpeta raiz no ambito global</p></div></div><div class="code"><div class="wrapper">global.root_path = path.normalize(__dirname) + <span class="hljs-string">'/'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Cargamos as configuracións</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(global.root_path + <span class="hljs-string">'config/loader.js'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Iniciamos a conexión da base de datos e cargamos os módulos</p></div></div><div class="code"><div class="wrapper"><span class="hljs-built_in">require</span>(config.paths.components + <span class="hljs-string">'database.js'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Inizializamos o servidor</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> app = express();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Cargamos a configuración do servidor</p></div></div><div class="code"><div class="wrapper"><span class="hljs-built_in">require</span>(config.paths.config + <span class="hljs-string">'express.js'</span>)(app);

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(process.console) === <span class="hljs-string">'undefined'</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Lanzamos o servidor pondoo a escoita no porto elexido</p></div></div><div class="code"><div class="wrapper">    app.listen(app.get(<span class="hljs-string">'port'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
        console.log(config.app.name + <span class="hljs-string">' started on port '</span> + app.get(<span class="hljs-string">'port'</span>));
    });
}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Expoñemos a app ó ámbito global</p></div></div><div class="code"><div class="wrapper">global.app = app;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Exportamos a app</p></div></div><div class="code"><div class="wrapper">module.exports = app;</div></div></div></div></body></html>